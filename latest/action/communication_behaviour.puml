@startuml
title las2peer Network: Behavior Flow

actor User
participant "New Node" as NewNode
participant "Pastry Overlay" as Overlay
participant "Bootstrap Node" as Bootstrap
participant "Service Node" as ServiceNode
participant "Service Agent" as ServiceAgent

== Node Join Process ==
User -> NewNode : Initiate node join request
NewNode -> Overlay : joinNetwork(bootstrapAddress)
Overlay -> Bootstrap : sendJoinRequest()
Bootstrap -> Overlay : return routingTable + leafSet
Overlay -> NewNode : joinSuccess()
NewNode -> User : notifyJoinSuccess

== Service Invocation ==
User -> NewNode : invokeService(serviceId, method, params)
NewNode -> NewNode : create encrypted + signed message
NewNode -> Overlay : sendMessage(msg)
Overlay -> ServiceNode : routeMessage(msg)
ServiceNode -> ServiceNode : process incoming message
ServiceNode -> ServiceAgent : dispatch request
ServiceAgent -> ServiceAgent : execute method
ServiceAgent -> ServiceNode : return result
ServiceNode -> Overlay : send response
Overlay -> NewNode : deliver response
NewNode -> User : return final result

@enduml
