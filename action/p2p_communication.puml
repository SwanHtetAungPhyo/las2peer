@startuml
actor User

participant "New Node\n(las2peer)" as NewNode
participant "Pastry Overlay\n(FreePastry)" as Overlay
participant "Bootstrap Node" as Bootstrap
participant "Service Node\n(las2peer)" as ServiceNode
participant "Service Agent\n(Running Service)" as ServiceAgent

title las2peer Network: Node Join and Service Invocation

== Node Join Process ==
NewNode -> Overlay : joinNetwork(bootstrapAddress)
Overlay -> Bootstrap : sendJoinRequest()
Bootstrap --> Overlay : returnRoutingTableInfo, leafSet
Overlay --> NewNode : confirmJoinSuccess()

== Service Invocation Process ==
User -> NewNode : invokeService(serviceId, method, params)
NewNode -> NewNode : createMessage(encrypted, signed)
NewNode -> Overlay : sendMessage(message)
Overlay -> ServiceNode : routeMessage(message)
ServiceNode -> ServiceNode : receiveMessage(message)
ServiceNode -> ServiceAgent : dispatchToService()
ServiceAgent -> ServiceAgent : executeMethod()
ServiceAgent --> ServiceNode : returnResult()
ServiceNode -> Overlay : sendResponse(message)
Overlay --> NewNode : deliverResponse()
NewNode --> User : returnResult()

@enduml