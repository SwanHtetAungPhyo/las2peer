@startuml
title las2peer Network: Behavior Flow

|User|
start
:Initiate node join request;

|New Node|
:Receive join request;
:Call joinNetwork(bootstrapAddress);

|Pastry Overlay|
:Process join network request;
:Send join request to bootstrap;

|Bootstrap Node|
:Receive join request;
:Prepare routing table info and leaf set;
:Return network information;

|Pastry Overlay|
:Receive network info;
:Confirm join success;

|New Node|
:Receive join confirmation;
:Notify user of successful join;

|User|
:Receive join confirmation;
:Invoke service with parameters;
note right: serviceId, method, params

|New Node|
:Receive service invocation;
:Create encrypted and signed message;
:Send message via overlay;

|Pastry Overlay|
:Receive message;
:Route message to appropriate service node;

|Service Node|
:Receive routed message;
:Process incoming message;
:Dispatch request to service agent;

|Service Agent|
:Receive service request;
:Execute requested method;
:Generate result;
:Return result to service node;

|Service Node|
:Receive execution result;
:Create response message;
:Send response via overlay;

|Pastry Overlay|
:Receive response;
:Deliver response to requesting node;

|New Node|
:Receive response;
:Process response;
:Return result to user;

|User|
:Receive final result;
stop

@enduml