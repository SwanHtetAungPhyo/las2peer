@startuml WebConnectorActivity
start

:Client sends HTTP request;
:WebConnector receives request;
:Parse headers and body;

if (Path is "/las2peer/auth/login"?) then (yes)
 :AuthHandler processes login;
 :Authenticate agent;
 if (Authentication successful?) then (yes)
   :Create/retrieve session;
   :Return HTTP 200 with session ID;
 else (no)
   :Return HTTP 401 Unauthorized;
 endif

elseif (Path is "/las2peer/auth/logout"?) then (yes)
 :AuthHandler processes logout;
 :Destroy session;
 :Return HTTP 200 logout success;

elseif (Path starts with "/las2peer"?) then (yes)
 :Process internal las2peer endpoint;
 :Return HTTP response;

else (other paths)
 :REST Mapper receives request;
 :Match URI to service method;
 :Identify agent from session;
 :Core Module routes to service;
 :las2peer Node invokes service;
 :Service Method executes;

 if (Service returns result?) then (yes)
   :Format successful response;
   :Return HTTP 200;
 else (error)
   :Map exception to error;
   :Return HTTP error response;
 endif
endif

:Client receives response;
stop
@enduml